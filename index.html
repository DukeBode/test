<!DOCTYPE html>
<html>

<head>
    <style>
        html {
            max-width: 100vh;
            margin: auto;
        }
    </style>
    <meta property="og:title" content="og 测试">
    <meta property="og:description" content="测试一下，og效果">
    <meta property="og:url" content="https://DukeBode.github.io/test">
    <meta property="og:image" content="Alipay.jpg">
    <!-- <meta property="og:type" content="article"> -->
    <!-- <meta property="og:" content=""> -->
    <!-- <meta property="og:" content=""> -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    
</head>

<body>
    
    
    <script type="text/javascript">
        var pair = {}
        const wlss = window.location.search.substr(1).split('&');
        for (let i = 0; i < wlss.length; i++) {
            tmp = wlss[i].split("=");
            pair[tmp[0]] = tmp[1];
        }
        AppID = `9a57dbd301288cd4`
        AppSecret=`53c6ae19438e8134ad907b71aad0034a`
        redirect_uri = `https://DukeBode.github.io/test/`
        state = "hello"
        let formdata = new FormData();
        if ("code" in pair) {
            formdata.append("client_id",AppID)
            formdata.append("client_secret",AppSecret)
            formdata.append("code",pair["code"])
            formdata.append("redirect_uri",redirect_uri)
            document.write(wlss)
        
        } else {
            location.href = `https://openapi.yiban.cn/oauth/authorize?client_id=${AppID}&redirect_uri=${redirect_uri}&state=${state}`
        }
        fetch(`https://openapi.yiban.cn/oauth/access_token`,{
            method: 'POST',
            body: formdata,
            mode:"no-cors"
        }).then(myjson=>console.log(myjson.json()))
        // 返回支付码
        function paycode(code) {
            let ua = navigator.userAgent
            for (i in code) {
                if (ua.search(` ${i}/`) > -1) return code[i]
            }
            return "/"
        }
        code = {
            'MicroMessenger': '/img/open/微信支付.png',
            'AlipayClient': '/img/open/支付宝支付.jpg',
            'QQ': '/img/open/'
        }
        document.write(`<img src="${paycode(code)}" alt="">`)
        document.write(paycode(code))
        document.write("<p>UserAgent: " + navigator.userAgent + "</p>");
//
// ""
// function getQueryVariable(variable)
// {
//        var query = window.location.search.substring(1);
//        var vars = query.split("&");
//        for (var i=0;i<vars.length;i++) {
//                var pair = vars[i].split("=");
//                if(pair[0] == variable){return pair[1];}
//        }
//        return(false);
// }
    </script>

    <p>技术支持：博德工作室</p>
</body>

</html>